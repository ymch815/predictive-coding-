# predictive-coding-mean-field-model

**Updated 09/23/22**

These are the codes for generating figure 6-10, S2-4, S6-7 in the following paper: 
Song Y, Yao M, Kemprecos H, Byrne A, Xiao Z, Zhang Q, Singh A, Wang J, Chen ZS. Predictive coding models for pain perception. J Comput Neurosci. 2021 May;49(2):107-127. doi: 10.1007/s10827-021-00780-x. Epub 2021 Feb 17. PMID: 33595765; PMCID: PMC8046732.
Article link: https://pubmed.ncbi.nlm.nih.gov/33595765/ 

The code annotations and readme was written based on an old version of figure labeling. Please refer to the following table to match texts in the repository with figures in the final paper. 

|In the repository|In the paper |
| ----------- | ----------- |
| Fig 7   | Fig 6, and E was removed       |
| Fig 8, 9, 10   | Fig 7, 8, 9        |
| Fig S1, 2, 3, 4, 5   | Fig S2, 3, 4, 6, 7        |

**Original note**

These are the codes for generating figure 7-10 and S1-5

1. Unzip the package and set the whole folder as a working path. 
2. For the following figures, you can generate them directly: Fig 7A/B, Fig 8B/C/F/G/H, Fig 9A/B, Fig 10C, Fig S1/2/3/5. 
3. For the following figures, you can either load prepared data or recalculate the data by uncommenting the codes. However, simulation process in these files may take some time: Fig 7C/D, Fig 8D/E, Fig 9C/D/E, Fig 10A/B, Fig S4. 
